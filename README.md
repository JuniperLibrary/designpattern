# è®¾è®¡æ¨¡å¼å®æˆ˜

![image-20220425203248829](https://bearbrick0.oss-cn-qingdao.aliyuncs.com/images/img/202204252032811.png)

ğŸ‘¾è®¾è®¡æ¨¡å¼demoå®æˆ˜ã€‚

é¡¹ç›®åœ°å€ï¼šhttps://github.com/bearbrick0/designpattern

## ğŸ«‘åˆ›å»ºå‹è®¾è®¡æ¨¡å¼

### ğŸ¥¦å•ä¾‹è®¾è®¡æ¨¡å¼

#### ğŸ¥æ‡’æ±‰æ¨¡å¼å®ç°å•ä¾‹æ¨¡å¼

##### æ‡’æ±‰å¼ï¼ˆ**å¤šçº¿ç¨‹ä¸‹çº¿ç¨‹ä¸å®‰å…¨**ï¼‰

(å…·ä½“å‚è€ƒ`com/uin/creationPattern/Singleton/LazyBones/LazyMan`)

è¿™ç§æ–¹å¼åœ¨å•çº¿ç¨‹çš„ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œå¯¹äºå¤šçº¿ç¨‹æ˜¯æ— æ³•ä¿è¯å•ä¾‹çš„ï¼Œè¿™é‡Œåˆ—å‡ºæ¥æ˜¯ä¸ºäº†å’Œåé¢ä½¿ç”¨é”ä¿è¯çº¿ç¨‹å®‰å…¨åšå¯¹æ¯”ã€‚

```java
package com.uin.creationPattern.Singleton.LazyBones.LazyMan;

/**
 * ç¬¬ä¸€ç§æ–¹æ³• æ‡’æ±‰(çº¿ç¨‹ä¸å®‰å…¨)
 */
public class Person {

    private String name;
    private int age;

    /**
     * æ‡’æ±‰--éœ€è¦çš„æ—¶å€™åœ¨åˆ›å»ºå¯¹è±¡
     */
    private static Person instance;

    /**
     * æ„é€ å™¨ç§æœ‰ï¼Œå¤–éƒ¨ä¸èƒ½å®ä¾‹åŒ–
     */
    private Person() {

    }

    /**
     * æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•ï¼Œå½“ä½¿ç”¨è¯¥æ–¹æ³•æ—¶æ‰å»åˆ›å»ºinstance
     */
    public static Person wanglufeiPerson() {
        //æ²¡æœ‰åœ¨å»åˆ›å»º
        if (instance == null) {
            instance = new Person();
        }
        return instance;
    }
}
```

```java
package com.uin.creationPattern.Singleton.LazyBones.LazyMan;

/**
 * \* Created with IntelliJ IDEA.
 * \* @author wanglufei
 * \* Date: 2021å¹´08æœˆ27æ—¥ 14:59
 * \* Description:
 * \
 */
public class MainTest {
    public static void main(String[] args) {
        //æµ‹è¯•
        Person person1 = Person.wanglufeiPerson();
        Person person2 = Person.wanglufeiPerson();
        System.out.println(person1 == person2);

        //æµ‹è¯•
        System.out.println(person1.hashCode());
        System.out.println(person2.hashCode());

        /**
         * æ€»ç»“: æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰ä¼˜ç¼ºç‚¹
         *     (1) èµ·åˆ°äº†Lazy Loaddingçš„æ•ˆæœï¼Œä½†æ˜¯åªèƒ½åœ¨å•çº¿ç¨‹çš„æƒ…å†µä¸‹ä½¿ç”¨
         *     (2) å¦‚æœåœ¨å¤šçº¿ç¨‹ä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹è¿›å…¥äº†if(instance==null)åˆ¤æ–­è¯­å¥å—ï¼Œè¿˜æœªæ¥å¾—åŠå¾€ä¸‹æ‰§è¡Œï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¹Ÿé€šè¿‡äº†
         *         è¿™ä¸ªåˆ¤æ–­è¯­å¥è¿™æ—¶å°±ä¼šäº§ç”Ÿå¤šä¸ªå®ä¾‹ã€‚æ‰€ä»¥åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ä¸å¯ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚
         * ç»“è®ºï¼š åœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸è¦ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚
         */
    }
}
```

- ä¼˜ç‚¹ï¼š æ‡’åŠ è½½
- ç¼ºç‚¹ï¼š çº¿ç¨‹ä¸å®‰å…¨

##### æ‡’æ±‰(åŠ å…¥åŒæ­¥é”çº¿ç¨‹å®‰å…¨)

(å‚è€ƒä»£ç `com/uin/creationPattern/Singleton/LazyBones/AddSynchronized/Singleton.`
`java)`

æ‡’æ±‰å¼å•ä¾‹å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨å‘¢ï¼Ÿé€šè¿‡ `synchronized` å…³é”®å­—åŠ é”ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œ `synchronized` å¯ä»¥æ·»åŠ åœ¨**â½…æ³•ä¸Šâ¾¯ï¼Œä¹Ÿå¯ä»¥æ·»åŠ åœ¨ä»£ç å—ä¸Šâ¾¯**ï¼Œè¿™â¾¥æ¼”ç¤ºæ·»åŠ åœ¨â½…æ³•ä¸Šâ¾¯ï¼Œå­˜åœ¨çš„é—®é¢˜æ˜¯æ¯â¼€æ¬¡è°ƒâ½¤ `getInstance()` è·å–å®ä¾‹æ—¶éƒ½éœ€è¦åŠ é”å’Œé‡Šæ”¾é”ï¼Œè¿™æ ·æ˜¯â¾®å¸¸å½±å“æ€§èƒ½çš„ã€‚

```java
package com.uin.creationPattern.Singleton.LazyBones.AddSynchronized;


/**
 * \* Created with IntelliJ IDEA.
 * \* @author wanglufei
 * \* Date: 2021å¹´08æœˆ27æ—¥ 16:58
 * \* Description: ç¬¬äºŒç§æ–¹æ³• æ‡’æ±‰ï¼ˆè§£å†³çº¿ç¨‹ä¸å®‰å…¨--åŠ å…¥äº†åŒæ­¥é”ï¼‰
 * \
 */
public class Singleton {

    //1. æ„é€ å™¨ç§æœ‰åŒ–,å¤–éƒ¨ä¸èƒ½åˆ›å»ºå®ä¾‹åŒ–å¯¹è±¡ï¼ˆnewï¼‰
    private Singleton() {

    }

    //2. æ‡’æ±‰--éœ€è¦çš„æ—¶å€™åœ¨åˆ›å»ºå¯¹è±¡
    private static Singleton instance;

    //3. æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•ï¼ŒåŠ å…¥äº†åŒæ­¥å¤„ç†çš„ä»£ç (åŒæ­¥é”)ï¼Œè§£å†³äº†çº¿ç¨‹ä¸å®‰å…¨çš„é—®é¢˜
    public static synchronized Singleton getInstance() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }

    public static void main(String[] args) {
        //æµ‹è¯•
        Singleton instance1 = Singleton.getInstance();
        Singleton instance2 = Singleton.getInstance();
        System.out.println(instance1==instance2);//true

        System.out.println(instance1.hashCode());//460141958
        System.out.println(instance2.hashCode());//460141958

       /**
        * æ€»ç»“: æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ åŠ synchronizedï¼‰ä¼˜ç¼ºç‚¹
        *   (1) è§£å†³äº†çº¿ç¨‹å®‰å…¨çš„é—®é¢˜
        *   (2) æ•ˆç‡å¤ªä½äº†ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨æƒ³è·å¾—ç±»çš„å®ä¾‹çš„æ—¶å€™ï¼Œæ‰§è¡ŒgetInstance()æ–¹æ³•éƒ½è¦è¿›è¡ŒåŒæ­¥ã€‚è€Œå…¶å®è¿™ä¸ªæ–¹æ³•åªæ‰§è¡Œä¸€æ¬¡å®ä¾‹
        *   åŒ–ä»£ç å°±å¤Ÿäº†ï¼Œåé¢çš„é¡¹è·å¾—è¯¥ç±»çš„å®ä¾‹ï¼Œç›´æ¥returnå°±è¡Œäº†ã€‚ä½†æ˜¯ä½ åœ¨getInstance()åé¢åŠ äº†synchronizedï¼Œåœ¨æ¯ä¸€æ¬¡éƒ½
        *   ä¼šåŒæ­¥ã€‚æ–¹æ³•è¿›è¡Œçš„åŒæ­¥æ•ˆç‡å¤ªä½ã€‚
        *   (3) ç»“è®ºï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸æ¨èä½¿ç”¨è¿™ç§æ–¹å¼
        *
        */
    }
}
```

- ä¼˜ç‚¹ï¼šæ‡’åŠ è½½ï¼Œçº¿ç¨‹å®‰å…¨
- ç¼ºç‚¹ï¼šæ•ˆç‡ä½

##### æ‡’æ±‰å¼(**åŒæ­¥ä»£ç å—**)

ï¼ˆå‚è€ƒä»£ç `com/uin/creationPattern/Singleton/LazyBones/SynchonizedCodeBlock/Singleton.java`ï¼‰

```java
package com.uin.creationPattern.Singleton.LazyBones.SynchonizedCodeBlock;

/**
 * \* Created with IntelliJ IDEA.
 * \* @author wanglufei
 * \* Date: 2021å¹´08æœˆ27æ—¥ 17:22
 * \* Description: ç¬¬ä¸‰ç§æ–¹æ³• æ‡’æ±‰å¼(åŒæ­¥ä»£ç å—)
 * \
 */
public class Singleton {

    //1. æ„é€ å™¨ç§æœ‰åŒ–,å¤–éƒ¨ä¸èƒ½åˆ›å»ºå®ä¾‹åŒ–å¯¹è±¡ï¼ˆnewï¼‰
    private Singleton() {

    }

    //2. æ‡’æ±‰--éœ€è¦çš„æ—¶å€™åœ¨åˆ›å»ºå¯¹è±¡
    private static Singleton instance;

    //3. æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•ï¼ŒåŠ å…¥äº†åŒæ­¥ä»£ç å—ï¼Œè§£å†³ä¸äº†çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ ä½†æ˜¯è¿˜æ˜¯æ•ˆç‡å¤ªä½
    public static Singleton getInstance() {
        if (instance == null) {
            synchronized (Singleton.class) {
                instance = new Singleton();
            }
        }
        return instance;
    }

    public static void main(String[] args) {
        //æµ‹è¯•
        Singleton instance1 = Singleton.getInstance();
        Singleton instance2 = Singleton.getInstance();
        System.out.println(instance1 == instance2);//true

        System.out.println(instance1.hashCode());//460141958
        System.out.println(instance2.hashCode());//460141958

        /**
         * æ€»ç»“: æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ åŠ synchronizedåŒæ­¥ä»£ç å—ï¼‰ä¼˜ç¼ºç‚¹
         *   (1) è¿™ç§æ–¹å¼ï¼Œæœ¬æ„æ˜¯æƒ³å¯¹åœ¨é™æ€æ–¹æ³•åŠ synchronizedçš„è¯¥è¿›ï¼Œå› ä¸ºå‰é¢çš„åŒæ­¥æ–¹æ³•çš„æ•ˆç‡å¤ªä½äº†ï¼Œæ”¹ä¸ºåŒæ­¥äº§ç”Ÿå®ä¾‹åŒ–
         *   çš„ä»£ç å—
         *   (2) ä½†æ˜¯è¿™ç§åŒæ­¥å¹¶ä¸èƒ½èµ·åˆ°çº¿ç¨‹å®‰å…¨çš„ä½œç”¨ã€‚å’Œæ‡’æ±‰å¼LazyManä¸é‡åˆ°çš„æƒ…å½¢ä¸€è‡´ã€‚å‡å¦‚ä¸€ä¸ªçº¿ç¨‹è¿›å…¥äº†	
         			if(instance==null)åˆ¤æ–­è¯­å¥æ¨¡å—ï¼Œè¿˜æœªæ¥çš„åŠå¾€ä¸‹æ‰§è¡Œï¼Œå¦ä¸ªä¸€ä¸ªçº¿ç¨‹ä¹Ÿé€šè¿‡äº†è¿™ä¸ªåˆ¤æ–­è¯­å¥ï¼Œè¿™æ—¶å°±ä¼šäº§ç”Ÿå¤šä¸ªå®ä¾‹ã€‚
         *   (3) ç»“è®ºï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸èƒ½ä½¿ç”¨è¿™ç§æ–¹å¼
         */
    }
}
```

##### æ‡’æ±‰å¼åŒé‡æ£€æŸ¥(DCL)

åŒé‡æ£€æŸ¥é”ï¼ˆ**DCL**ï¼Œ å³ **double-checked locking**ï¼‰

å‚è€ƒä»£ç (`com/uin/creationPattern/Singleton/LazyBones/DoubbleCheck/Singleton.java)`

Double-Checkæ¦‚å¿µæ˜¯å¤šçº¿ç¨‹å¼€å‘ä¸­å¸¸ä½¿ç”¨åˆ°çš„ï¼Œå¦‚ä»£ç æ‰€ç¤ºï¼Œæˆ‘ä»¬è¿›è¡Œäº†ä¸¤æ¬¡`if(singleton==null)`æ£€æŸ¥ï¼Œè¿™æ ·å°±ä¿è¯äº†çº¿ç¨‹å®‰å…¨ã€‚

è¿™æ ·ï¼Œå®ä¾‹åŒ–ä»£ç åªç”¨æ‰§è¡Œä¸€æ¬¡ï¼Œåé¢å†æ¬¡è®¿é—®æ—¶ï¼Œç›´æ¥`if(singleton==null)`ï¼Œä¸º`FALSE`ï¼Œç›´æ¥`return`å®ä¾‹åŒ–å¯¹è±¡ï¼Œä¹Ÿé¿å…äº†åå¤è¿›è¡Œæ–¹æ³•åŒæ­¥ã€‚

è¿™â¾¥çš„åŒé‡æ£€æŸ¥æ˜¯æŒ‡ä¸¤æ¬¡â¾®ç©ºåˆ¤æ–­ï¼Œé”æŒ‡çš„æ˜¯ `synchronized` åŠ é”ï¼Œä¸ºä»€ä¹ˆè¦è¿›â¾åŒé‡åˆ¤æ–­ï¼Œå…¶å®å¾ˆç®€å•ï¼Œç¬¬â¼€é‡åˆ¤æ–­ï¼Œå¦‚æœå®ä¾‹å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆå°±ä¸å†éœ€è¦è¿›â¾åŒæ­¥æ“ä½œï¼Œâ½½æ˜¯ç›´æ¥è¿”å›è¿™ä¸ªå®ä¾‹ï¼Œå¦‚æœæ²¡æœ‰åˆ›å»ºï¼Œæ‰ä¼šè¿›â¼ŠåŒæ­¥å—ï¼ŒåŒæ­¥å—çš„â½¬çš„ä¸ä¹‹å‰ç›¸åŒï¼Œâ½¬çš„æ˜¯ä¸ºäº†é˜²â½Œæœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶è°ƒâ½¤æ—¶ï¼Œå¯¼è‡´â½£æˆå¤šä¸ªå®ä¾‹ï¼Œæœ‰äº†åŒæ­¥å—ï¼Œæ¯æ¬¡åªèƒ½æœ‰â¼€ä¸ªçº¿ç¨‹è°ƒâ½¤è®¿é—®åŒæ­¥å—å†…å®¹ï¼Œå½“ç¬¬â¼€ä¸ªæŠ¢åˆ°é”çš„è°ƒâ½¤è·å–äº†å®ä¾‹ä¹‹åï¼Œè¿™ä¸ªå®ä¾‹å°±ä¼šè¢«åˆ›å»ºï¼Œä¹‹åçš„æ‰€æœ‰è°ƒâ½¤éƒ½ä¸ä¼šè¿›â¼ŠåŒæ­¥å—ï¼Œç›´æ¥åœ¨ç¬¬â¼€é‡åˆ¤æ–­å°±è¿”å›äº†å•ä¾‹ã€‚

å…³äºå†…éƒ¨çš„ç¬¬â¼†é‡ç©ºåˆ¤æ–­çš„ä½œâ½¤ï¼Œå½“å¤šä¸ªçº¿ç¨‹â¼€èµ·åˆ°è¾¾é”ä½ç½®æ—¶ï¼Œè¿›â¾é”ç«äº‰ï¼Œå…¶ä¸­â¼€ä¸ªçº¿ç¨‹è·å–é”ï¼Œå¦‚æœæ˜¯ç¬¬â¼€æ¬¡è¿›â¼Šåˆ™ä¸º nullï¼Œä¼šè¿›â¾å•ä¾‹å¯¹è±¡çš„åˆ›å»ºï¼Œå®Œæˆåé‡Šæ”¾é”ï¼Œå…¶ä»–çº¿ç¨‹è·å–é”åå°±ä¼šè¢«ç©ºåˆ¤æ–­æ‹¦æˆªï¼Œç›´æ¥è¿”å›å·²åˆ›å»ºçš„å•ä¾‹å¯¹è±¡ã€‚

å…¶ä¸­æœ€å…³é”®çš„â¼€ä¸ªç‚¹å°±æ˜¯ volatile å…³é”®å­—çš„ä½¿â½¤ï¼Œå…³äº volatile çš„è¯¦ç»†ä»‹ç»å¯ä»¥åœ¨æˆ‘çš„åšå®¢ä¸­æœç´¢å³å¯ï¼Œè¿™â¾¥ä¸åšè¯¦ç»†ä»‹ç»ï¼Œç®€å•è¯´æ˜â¼€ä¸‹ï¼ŒåŒé‡æ£€æŸ¥é”ä¸­ä½¿â½¤ `volatile` çš„ä¸¤ä¸ªé‡è¦ç‰¹æ€§ï¼šå¯â»…æ€§ã€ç¦â½ŒæŒ‡ä»¤é‡æ’åº

è¿™â¾¥ä¸ºä»€ä¹ˆè¦ä½¿â½¤ `volatile` ï¼Ÿ

è¿™æ˜¯å› ä¸º new å…³é”®å­—åˆ›å»ºå¯¹è±¡ä¸æ˜¯åŸâ¼¦æ“ä½œï¼Œåˆ›å»ºâ¼€ä¸ªå¯¹è±¡ä¼šç»å†ä¸‹â¾¯çš„æ­¥éª¤ï¼š

1. åœ¨å †å†…å­˜å¼€è¾Ÿå†…å­˜ç©ºé—´

2. è°ƒâ½¤æ„é€ â½…æ³•ï¼Œåˆå§‹åŒ–å¯¹è±¡

3. å¼•â½¤å˜é‡æŒ‡å‘å †å†…å­˜ç©ºé—´

å¯¹åº”å­—èŠ‚ç æŒ‡ä»¤å¦‚ä¸‹ï¼š

<img src="https://bearbrick0.oss-cn-qingdao.aliyuncs.com/images/img/202204252024949.png" alt="image-20220425202421265" style="zoom:50%;" />

ä¸ºäº†æâ¾¼æ€§èƒ½ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¸¸å¸¸ä¼šå¯¹æ—¢å®šçš„ä»£ç æ‰§â¾é¡ºåºè¿›â¾æŒ‡ä»¤é‡æ’åºï¼Œä»æºç åˆ°æœ€ç»ˆæ‰§â¾æŒ‡ä»¤ä¼šç»å†å¦‚ä¸‹æµç¨‹ï¼š

æºç ç¼–è¯‘å™¨ä¼˜åŒ–é‡æ’åºæŒ‡ä»¤çº§å¹¶â¾é‡æ’åºå†…å­˜ç³»ç»Ÿé‡æ’åºæœ€ç»ˆæ‰§â¾æŒ‡ä»¤åºåˆ—æ‰€ä»¥ç»è¿‡æŒ‡ä»¤é‡æ’åºä¹‹åï¼Œåˆ›å»ºå¯¹è±¡çš„æ‰§â¾é¡ºåºå¯èƒ½ä¸º 1 2 3 æˆ–è€… 1 3 2 ï¼Œå› æ­¤å½“æŸä¸ªçº¿ç¨‹åœ¨ä¹±åºè¿â¾ 1 3 2 æŒ‡ä»¤çš„æ—¶å€™ï¼Œå¼•â½¤å˜é‡æŒ‡å‘å †å†…å­˜ç©ºé—´ï¼Œè¿™ä¸ªå¯¹è±¡ä¸ä¸º nullï¼Œä½†æ˜¯æ²¡æœ‰åˆå§‹åŒ–ï¼Œå…¶ä»–çº¿ç¨‹æœ‰å¯èƒ½è¿™ä¸ªæ—¶å€™è¿›â¼Šäº† getInstance çš„ç¬¬â¼€ä¸ª if(instance == null) åˆ¤æ–­ä¸ä¸º nulll ï¼Œå¯¼è‡´é”™è¯¯ä½¿â½¤äº†æ²¡æœ‰åˆå§‹åŒ–çš„â¾® null å®ä¾‹ï¼Œè¿™æ ·çš„è¯å°±ä¼šå‡ºç°å¼‚å¸¸ï¼Œè¿™ä¸ªå°±æ˜¯è‘—åçš„DCL å¤±æ•ˆé—®é¢˜ã€‚

å½“æˆ‘ä»¬åœ¨å¼•â½¤å˜é‡ä¸Šâ¾¯æ·»åŠ  volatile å…³é”®å­—ä»¥åï¼Œä¼šé€šè¿‡åœ¨åˆ›å»ºå¯¹è±¡æŒ‡ä»¤çš„å‰åæ·»åŠ å†…å­˜å±éšœæ¥ç¦â½ŒæŒ‡ä»¤é‡æ’åºï¼Œå°±å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜ï¼Œâ½½ä¸”å¯¹volatile ä¿®é¥°çš„å˜é‡çš„ä¿®æ”¹å¯¹å…¶ä»–ä»»ä½•çº¿ç¨‹éƒ½æ˜¯å¯â»…çš„ã€‚

```java
package com.uin.creationPattern.Singleton.LazyBones.DoubbleCheck;

/**
 * \* Created with IntelliJ IDEA.
 * \* @author wanglufei
 * \* Date: 2021å¹´08æœˆ27æ—¥ 17:39
 * \* Description: ç¬¬å››ç§ æ‡’æ±‰åŒé‡æ£€æŸ¥
 * \
 */
public class Singleton {

    /**
     * å½“ä¸€ä¸ªå˜é‡å®šä¹‰ä¸ºvolatileä¹‹åï¼Œå®ƒå°†å…·å¤‡ä¸¤ç§ç‰¹æ€§
     *     1. ä¿è¯æ­¤å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§
     *        è¿™é‡Œä¸åšè¿‡å¤šè§£é‡Šï¼Œç®€å•çš„è¯´å°±æ˜¯ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†volatileå˜é‡ä¹‹åï¼Œå®ƒå…ˆå†™å…¥å®ƒçš„å·¥ä½œå†…å­˜ä¸­ï¼Œ
     *        ç„¶åç«‹åˆ»å†™å…¥ä¸»å†…å­˜ï¼Œå¹¶ä¸”åˆ·æ–°å…¶ä»–çº¿ç¨‹ä¸­çš„å·¥ä½œå†…å­˜ï¼Œè¿™æ ·å…¶ä»–çº¿ç¨‹å†å»è¯»å–ä»–ä»¬å·¥ä½œå†…å­˜ä¸­çš„å˜é‡æ—¶ï¼Œ
     *        ç¡®ä¿èƒ½å¤Ÿæ‹¿åˆ°æœ€æ–°çš„ã€‚ä½†æ˜¯å¦‚æœæ˜¯æ™®é€šå˜é‡çš„è¯ï¼Œå®ƒä¸ä¼šç«‹å³å†™å…¥ä¸»å†…å­˜ä¸­ï¼Œæ‰€æœ‰å…¶ä»–çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ä¿å­˜çš„æ˜¯æ—§çš„å€¼ã€‚
     *        æ‰€æœ‰volatileå˜é‡å¯ä»¥ä¿è¯å¯è§æ€§ã€‚
     *     2. ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–
     */
    private static volatile Singleton instance;

    //1. æ„é€ å™¨ç§æœ‰åŒ–ï¼Œå¤–éƒ¨ä¸èƒ½é€šè¿‡newæ¥å®ä¾‹åŒ–å¯¹è±¡
    private Singleton() {

    }
    //æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•ï¼ŒåŠ å…¥åŒé‡æ£€æŸ¥ä»£ç ï¼Œè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼ŒåŒæ—¶è§£å†³æ‡’åŠ è½½é—®é¢˜
    public static Singleton getInstance() {
        if (instance == null) {
            synchronized (Singleton.class) {
                if (instance == null) {
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }

    public static void main(String[] args) {
        Singleton instance1 = Singleton.getInstance();
        Singleton instance2 = Singleton.getInstance();

        //æµ‹è¯•
        System.out.println(instance1==instance2);

        System.out.println(instance1.hashCode());
        System.out.println(instance2.hashCode());
    }
}
```

- ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼šå»¶è¿ŸåŠ è½½ï¼›æ•ˆç‡è¾ƒé«˜
- ç»“è®ºï¼š åœ¨å®é™…å¼€å‘ä¸­ï¼Œæ¨èä½¿ç”¨è¿™ç§çš„å•ä¾‹è®¾è®¡æ¨¡å¼

#### ğŸ¥¥æ¶æ±‰æ¨¡å¼å®ç°å•ä¾‹æ¨¡å¼

##### æ¶æ±‰å¼(é™æ€å˜é‡)



```java
package com.uin.creationPattern.Singleton.BadMash.StaticConstants;

/**
 * \* Created with IntelliJ IDEA.
 * \* @author wanglufei
 * \* Date: 2021å¹´08æœˆ27æ—¥ 15:07
 * \* Description: ç¬¬ä¸€ç§ æ¶æ±‰å¼(é™æ€å˜é‡)
 * \
 */
public class singleton {

    //1. æ„é€ å™¨ç§æœ‰åŒ–,å¤–éƒ¨ä¸èƒ½åˆ›å»ºå®ä¾‹åŒ–å¯¹è±¡ï¼ˆnewï¼‰
    private singleton() {

    }

    //2. åœ¨ç±»å†…éƒ¨åˆ›å»ºå®ä¾‹åŒ–å¯¹è±¡
    private static final singleton instance = new singleton();

    //3. å¯¹å¤–æä¾›ä¸€ä¸ªå…¬æœ‰çš„é™æ€æ–¹æ³•ï¼Œè¿”å›å®ä¾‹å¯¹è±¡
    public static singleton getInstance() {
        return instance;
    }
}
```



##### æ¶æ±‰é™æ€ä»£ç å—







### ğŸ…åŸå‹è®¾è®¡æ¨¡å¼

### ğŸ†æŠ½è±¡å·¥å‚è®¾è®¡æ¨¡å¼

### ğŸ¥‘å»ºé€ è€…è®¾è®¡æ¨¡å¼

## ğŸŒ½ç»“æ„å‹è®¾è®¡æ¨¡å¼


## ğŸ¥•è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼
